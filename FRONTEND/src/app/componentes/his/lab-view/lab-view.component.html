
<app-content-his>
    <mat-toolbar class="mat-elevation-z4" color="primary">
        <h1>LAB</h1>
    </mat-toolbar>

    <mat-card>
        <mat-card-content>            
            <form [formGroup]="myForm"> 
                <mat-form-field appearance="fill">
                    <mat-label>วันที่ เริ่ม-สิ้นสุด</mat-label>
                        <mat-date-range-input [rangePicker]="picker">
                            <input matStartDate placeholder="Start date" readonly formControlName="lab_start_date">
                            <input matEndDate placeholder="End date" readonly formControlName="lab_end_date">
                        </mat-date-range-input>  
                        <mat-datepicker-toggle matSuffix [for]="picker">
                          <mat-icon matDatepickerToggleIcon>calendar_month</mat-icon>
                        </mat-datepicker-toggle>
                        <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>   
                    <mat-date-range-picker #picker></mat-date-range-picker> 
                </mat-form-field>         
            </form> 
        </mat-card-content>
        <mat-card-actions>
          <button *ngIf="!loading" mat-raised-button color="primary" (click)="labReport()" >รายงาน</button>
          <button *ngIf="labResult.length > 0"  mat-raised-button color="primary" (click)="exportExcel()">ส่งออก</button>
          <button mat-button color="warn">ยกเลิก</button>
        </mat-card-actions>
    </mat-card> 

    <br>
    
        <h1 style="display: flex; align-items: center;"><mat-icon matSuffix>description </mat-icon> รายการ</h1>   
        
        <div style="text-align: center;" *ngIf="loading">
          <mat-spinner style="margin: 0 auto;"></mat-spinner>
          <p>กำลังโหลดข้อมูล</p>
        </div>

        <div style="overflow-x: scroll;">
          <table *ngIf="labResult.length > 0">
            <tr>
              <th>vn</th>
              <th>cid</th>
              <th>pname</th>
              <th>fname</th>
              <th>lanme</th>
              <th>hn</th>
              <th>pttype</th>
              <th>age</th>
              <th>รอบเอว(cm)</th>
              <th>ส่วนสู่ง</th>
              <th>น้ำหนัก</th>
              <th>BMI</th>
              <th>SysBP</th>
              <th>DiasBP</th>
              <th>order_date</th>
              <th>receive_date</th>
              <th>receive_time</th>
              <th>report_date</th>
              <th>report_time</th>
              <th>approve_date</th>
              <th>HbA1C</th>
              <th>Creatinine</th>
              <th>eGFR</th>
              <th>Tri</th>
              <th>LDL</th>
              <th>HDL</th>
            </tr>
            <tr *ngFor="let item of labResult">
              <td>{{item.vn}}</td>
              <td>{{item.cid}}</td>
              <td>{{item.pname}}</td>
              <td>{{item.fname}}</td>
              <td>{{item.lname}}</td>
              <td>{{item.hn}}</td>
              <td>{{item.pttype}}</td>
              <td>{{item.age}}</td>
              <td>{{item.waist}}</td>
              <td>{{item.height}}</td>
              <td>{{item.bw}}</td>
              <td>{{item.bmi}}</td>
              <td>{{item.SysBP}}</td>
              <td>{{item.DiasBP}}</td>
              <td>{{item.order_date}}</td>
              <td>{{item.receive_date}}</td>
              <td>{{item.receive_time}}</td>
              <td>{{item.report_date}}</td>
              <td>{{item.report_time}}</td>
              <td>{{item.approve_date}}</td>
              <td>{{item.HbA1C}}</td>
              <td>{{item.Creatinine}}</td>
              <td>{{item.eGFR}}</td>
              <td>{{item.Tri}}</td>
              <td>{{item.LDL}}</td>
              <td>{{item.HDL}}</td>
            </tr>
          </table>
        </div>       
  <div>
  
  </div>
</app-content-his>